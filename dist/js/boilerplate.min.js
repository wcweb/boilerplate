/*!
 * Boilerplate v3.0.2 by @wcweb
 * Copyright 2013 wcweb.us.
 * Licensed under http://www.apache.org/licenses/LICENSE-2.0
 *
 * Designed and built with all the love in the world by @wcweb.
 */

function is_ie(){return/MSIE/g.test(window.navigator.userAgent)}function getInternetExplorerVersion(){var a=-1;if("Microsoft Internet Explorer"==navigator.appName){var b=navigator.userAgent,c=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=c.exec(b)&&(a=parseFloat(RegExp.$1))}return a}if("undefined"==typeof jQuery)throw new Error("It requires jQuery");var Rimifon={Ads:{},NewFloatAd:function(a,b){var c=document.createElement("a");return c.DirV=!0,c.DirH=!0,c.AutoMove=!0,c.Image=new Image,c.Seed=Math.random(),c.Timer=setInterval("Rimifon.Float("+c.Seed+")",50),this.Ads[c.Seed]=c,c.Image.Parent=c,c.style.position="absolute",c.style.left=0,c.style.top=0,c.style.zIndex=200,c.Image.style.width="197px",c.Image.style.height="197px",c.Image.style.zIndex=202,c.Image.src=a,c.Image.onmouseover=function(){this.Parent.AutoMove=!1},c.Image.onmouseout=function(){this.Parent.AutoMove=!0},b&&(c.href=b,c.Image.border=0,c.target="_blank"),c.appendChild(c.Image),$("#ad_banner").append(c),c},Float:function(a){var b=this.Ads[a];if(b.AutoMove){var c=parseInt(b.style.left),d=parseInt(b.style.top);b.offsetWidth+c>document.body.clientWidth+document.body.scrollLeft-1&&(c=document.body.scrollLeft+document.body.clientWidth-b.offsetWidth,b.DirH=!1),b.offsetHeight+d>document.body.clientHeight+document.body.scrollTop-1&&(d=document.body.scrollTop+document.body.clientHeight-b.offsetHeight,b.DirV=!1),c<document.body.scrollLeft&&(c=document.body.scrollLeft,b.DirH=!0),d<document.body.scrollTop&&(d=document.body.scrollTop,b.DirV=!0),b.style.left=c+(b.DirH?1:-1)+"px",b.style.top=d+(b.DirV?1:-1)+"px"}}};if(!Limit)var Limit={};Limit.scrollToTop=function(a){$(a).hide().removeAttr("href"),"0"!=$(window).scrollTop()&&$(a).fadeIn("slow");var b=$(a);$(window).scroll(function(){"0"==$(window).scrollTop()?$(b).fadeOut("slow"):$(b).fadeIn("slow")}),$(a).click(function(){$("html, body").animate({scrollTop:0},"slow")})},Limit.setup=function(){$('a[href^="http://"]').filter(function(){return this.hostname&&this.hostname!==location.hostname}).attr("target","_blank"),$("#animated").each(function(){$(this).hover(function(){$(this).stop().animate({opacity:.9},400)},function(){$(this).stop().animate({opacity:0},200)})}),$("a#totop").length&&Limit.scrollToTop("a#totop"),$(".content-box").length&&($(".content-box .head").css({cursor:"s-resize"}),$(".content-box .body").slideUp(),$(".content-box .head").toggle(function(){var a=this;$(this).parent().find(".body").slideDown("slow",function(){$(a).find(".caption").toggleClass("content-box-closed")})},function(){var a=this;$(this).parent().find(".body").slideUp("slow",function(){$(a).find(".caption").toggleClass("content-box-closed")})})),$(".collapse").length},$("#list-grid-toggle").length&&($(".list-toggle-btn").click(function(a){$(a.currentTarget).hasClass("list-toggle-btn-up")&&($(a.currentTarget).toggleClass("list-toggle-btn-on list-toggle-btn-up"),$(".grid-toggle-btn").toggleClass("grid-toggle-btn-on grid-toggle-btn-up"),$("#list-grid-toggle").addClass("videolist-heng")),a.preventDefault()}),$(".grid-toggle-btn").click(function(a){$(a.currentTarget).hasClass("grid-toggle-btn-up")&&($(".list-toggle-btn").toggleClass("list-toggle-btn-on list-toggle-btn-up"),$(a.currentTarget).toggleClass("grid-toggle-btn-on grid-toggle-btn-up"),$("#list-grid-toggle").removeClass("videolist-heng")),a.preventDefault()})),$(function(){$(".toggle-info").slideUp("fast"),$(".toggle-info-btn").toggle(function(){var a=this;$("#"+$(this).attr("rel")).slideDown("slow",function(){$(a).children().html("隐藏信息")})},function(){var a=this;$("#"+$(this).attr("rel")).slideUp("fast",function(){$(a).children().html("显示信息")})})}),function(a){function b(){g.content="width=device-width,minimum-scale="+f[0]+",maximum-scale="+f[1],a.removeEventListener(d,b,!0)}var c="addEventListener",d="gesturestart",e="querySelectorAll",f=[1,1],g=e in a?a[e]("meta[name=viewport]"):[];(g=g[g.length-1])&&c in a&&(b(),f=[.25,1.6],a[c](d,b,!0))}(document),function(a){var b={init:function(b){return this.each(function(){var c=a(this);c.data("marquee",b);var d=a(">li",c);c.wrap('<div class="slide_container"></div>').height(c.height()).hover(function(){a(this).data("marquee").stop&&a(this).stop(!0,!1)},function(){a(this).data("marquee").stop&&a(this).marquee("slide")}).parent().css({position:"relative",overflow:"hidden",height:a(">li",c).height()}).find(">ul").css({width:2*screen.width,position:"absolute"});for(var e=0;e<Math.ceil(3*screen.width/c.width());++e)c.append(d.clone());c.marquee("slide")})},slide:function(){var b=this;b.animate({left:-1*a(">li",b).width()},b.data("marquee").duration,"swing",function(){b.css("left",0).append(a(">li:first",b)),b.delay(b.data("marquee").delay).marquee("slide")})}};a.fn.marquee=function(c){var d={delay:2e3,duration:900,stop:!0};return"object"!=typeof c&&c?b[c].apply(this):(c&&a.extend(d,c),b.init.apply(this,[d]))}}(jQuery),$(document).ready(function(){$(".slide").marquee({delay:3e3})}),$(window).on("load resize",function(){}),$(function(){$("#nav-category").length&&$(".nav-list:first a").click(function(a){void 0!==$(a.currentTarget).attr("data-target")&&($(".nav-list:first .nav-list .in").collapse("toggle"),$(".nav-list:first .nav-list .collapse").filter(".in").collapse("hide"))})}),$(document).ready(function(){"message-here"!==$(".flash_messages").children().filter("p").html()&&$(".flash_messages").fadeIn()}),window.flash=function(a){if($(".flash_messages")){var b=$(".flash_messages").first().clone(!0);$(b).children().filter("p").html(a),$(".flash_messages").last().before($(b)),$(b).fadeIn(),setTimeout(function(){$(b).fadeOut()},1e4)}},function(a,b,c){function d(b,c){this.element=a(b),this.options=a.extend({},f,c),this._defaults=f,this._name=e,b&&this.init()}!function(){var a={};this.tmpl=function b(d,e){var f=/\W/.test(d)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+d.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):a[d]=a[d]||b(c.getElementById(d).innerHTML);return e?f(e):f}}();{var e="LiveScheduler",f={weekStart:1,msg_days:["Su","Mo","Tu","We","Th","Fr","Sa"],msg_months:["January","February","March","April","May","June","July","August","September","October","November","December"],msg_today:"Today",msg_events_today:"Events Today",url:"",currentday:null,events:null},g=tmpl('<div class=" timeline "><div class="operator"><ul class="nav nav-pills"><li class="fast pre"><a href="#" class="">上一周</a></li><li class="pre"><a href="#" class="">&lt</a></li><li class="next"><a href="#" class="">&gt</a></li><li class="fast next"><a href="#" class="">下一周</a></li></ul></div></div>'),h=tmpl('<ul class="nav nav-tabs" id="days_tabs"><% for (var i = 0, length = seven_day.length; i < length; i ++) { %><li class="select_day select_by_<%= seven_day[i].format("D") %>" ><a href="#d<%= seven_day[i].format("D") %>"  data-toggle="tab"><%= seven_day[i].format("dddd") %><br/> <%= seven_day[i].format("MM-DD") %></a></li><% } %></ul></ul>'),i='<div class="tab-content" id="accordion_event_table" ><% for (var ix = 0, lengthx = seven_day_events.length; ix < lengthx; ix ++) { %><div class="tab-pane" id="d<%= r_days[ix].format("D") %>"><% if (seven_day_events[ix].length>0){ %><table class="table live_table"><thead><tr><th>课程名称</th><th>学科</th><th>授课时间</th><th>授课地点</th><th>状态</th><th>操作</th></tr></thead><tbody><% for (var jx = 0 ,sde=seven_day_events[ix][0], lengthy = seven_day_events[ix][0].LiveInfo.length; jx < lengthy; jx ++) { %> <tr class="event"><td class="event_title"><% if (sde.LiveInfo[jx].url  ){%><a href="<%= sde.LiveInfo[jx].url%>"> <%= sde.LiveInfo[jx].title %></a> <%}else{%><%= sde.LiveInfo[jx].title %><% }%><td class="event_course"><%= sde.LiveInfo[jx].course %></td></td><td class="event_time"><%= sde.LiveInfo[jx].time%></td><td class="event_classroom"><%= sde.LiveInfo[jx].classroom%></td> <td style="background-color:<%= sde.LiveInfo[jx].color %>;"> <%= sde.LiveInfo[jx].status %> </td><td><a href="<%= sde.LiveInfo[jx].url ? sde.LiveInfo[jx].url : "#" %>"><%= sde.LiveInfo[jx].url_title %></a></td> </tr><% } %></tbody></table><% } else { %>当天没有直播信息！<% }%></div><% } %>';new Date}d.prototype.init=function(){var a=moment();this.weekStart=this.options.weekStart||1,this.othersParams=this.options.otherParams||"",this.url=this.options.url,this.paramsData=j(this.options.otherParams),this.currentday=this.options.currentday?this.options.currentday:a,this.renderCalendar(k(this.currentday))},d.prototype.renderCalendar=function(b){a(this.element).contents().remove();var c=this,d=tmpl(i);this.calendar=a(h({seven_day:b})).appendTo(this.element),this.timeline=a(g({})).appendTo(this.element).on({click:a.proxy(this.click,this)}),this.calendar.on({click:a.proxy(this.click,this)}),this.paramsData.days=_.map(b,function(a){return moment(a).utc().format()}),a.ajax({type:"POST",url:this.url,data:this.paramsData,dataType:"json",jsonp:!1}).done(function(e){var f=e;if(f.length>0){var g=_.map(b,function(a){return moment(a).utc().format()});c.events=_.map(g,function(a){return _.filter(f,function(b){return b.date=moment(b.date),b.date.date()==moment(a).date()})});var h={seven_day_events:c.events,r_days:b};a(d(h)).appendTo(c.element)}a("#days_tabs .select_by_"+moment(this.currentday).format("D")+" a").tab("show")}).fail(function(){})},d.prototype.click=function(b){b.stopPropagation(),b.preventDefault();var c=a(b.target).closest("li");1==c.length&&(c.is(".pre")?c.is(".fast")?(this.currentday=moment(this.currentday).subtract("d",7),this.renderCalendar(k(this.currentday))):(this.currentday=moment(this.currentday).subtract("d",1),this.renderCalendar(k(this.currentday))):c.is(".next")?c.is(".fast")?(this.currentday=moment(this.currentday).add("d",7),this.renderCalendar(k(this.currentday))):(this.currentday=moment(this.currentday).add("d",1),this.renderCalendar(k(this.currentday))):c.is(".select_day")&&(a(c).children("a").tab("show"),a(a(c).children("a").attr("href")).children(".live_table").dataTable({bRetrieve:!0,sDom:"<'row'<'span4'l><'span5 pull-right'f>r>t<'row'<'span4'i><'span5 pull-right'p>>",sPaginationType:"bootstrap",oLanguage:{sLengthMenu:"_MENU_ 条记录 每一页"}})))};var j=function(a){var b,c,d=a.split("&"),e={};for(b=0;b<d.length;b++)c=d[b].split("="),e[c[0]]=escape(c[1]);return e},k=function(a){var b=[],c=moment(a).subtract("d",4);return _(7).times(function(){var a=c.add("d",1);b.push(moment(a))}),b};a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))})}}(jQuery,window,document);